<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from org.apache.maven.plugins:maven-pmd-plugin:3.24.0:cpd at 2025-04-17

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Emissary &#x2013; CPD Results</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">Emissary
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2025-04-17</span>
           | <span id="projectVersion">Version: 8.26.0</span>
      </div>
      <div class="xright"><a href="https://github.com/NationalSecurityAgency/emissary" class="externalLink" title="Emissary">Emissary</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
     <li class="expanded"><a href="project-reports.html" title="Project Reports">Project Reports</a>
      <ul>
       <li class="none"><a href="apidocs/index.html" title="Javadoc">Javadoc</a></li>
       <li class="none"><a href="testapidocs/index.html" title="Test Javadoc">Test Javadoc</a></li>
       <li class="none"><a href="xref/index.html" title="Source Xref">Source Xref</a></li>
       <li class="none"><a href="xref-test/index.html" title="Test Source Xref">Test Source Xref</a></li>
       <li class="none"><a href="surefire-report.html" title="Surefire">Surefire</a></li>
       <li class="none"><a href="dependency-updates-aggregate-report.html" title="Dependency Updates Aggregate Report">Dependency Updates Aggregate Report</a></li>
       <li class="none"><a href="plugin-updates-aggregate-report.html" title="Plugin Updates Aggregate Report">Plugin Updates Aggregate Report</a></li>
       <li class="none"><a href="property-updates-aggregate-report.html" title="Property Updates Aggregate Report">Property Updates Aggregate Report</a></li>
       <li class="none"><a href="jacoco/index.html" title="JaCoCo">JaCoCo</a></li>
       <li class="none"><a href="jacoco-aggregate/index.html" title="JaCoCo Aggregate">JaCoCo Aggregate</a></li>
       <li class="none"><a href="checkstyle.html" title="Checkstyle">Checkstyle</a></li>
       <li class="none"><strong>CPD</strong></li>
       <li class="none"><a href="pmd.html" title="PMD">PMD</a></li>
      </ul></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<section>
<h2><a name="CPD_Results"></a>CPD Results</h2><a name="CPD_Results"></a>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 7.3.0.</p><section>
<h3><a name="Duplications"></a>Duplications</h3><a name="Duplications"></a>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L309">309</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L411">411</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>kff = new KffDataObjectHandler(true, true, true);
        payload.setParameter(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME, &quot;test.filter&quot;);
        payload.setChannelFactory(SBC_DATA);
        kff.hash(payload);
        assertEquals(&quot;test.filter&quot;, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_BASE + &quot;FILTERED_BY&quot;));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_BASE + &quot;FILTERED_BY&quot;));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_BASE + &quot;FILTERED_BY&quot;));
        assertTrue(KffDataObjectHandler.hashPresent(payload));
        assertEquals(DATA_MD5, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_CRC32, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_BASE + &quot;CRC32&quot;));
        assertEquals(DATA_CRC32, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_BASE + &quot;CRC32&quot;));
        assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_BASE + &quot;CRC32&quot;));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(KffDataObjectHandler.KFF_DUPE_CURRENT_FORM, payload.getFileType());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L120">120</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L195">195</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>kff = new KffDataObjectHandler(true, true, true);
        payload.setParameter(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME, &quot;test.filter&quot;);
        kff.hash(payload);
        assertEquals(&quot;test.filter&quot;, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertTrue(KffDataObjectHandler.hashPresent(payload));
        assertEquals(DATA_MD5, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_CRC32, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_CRC32, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L121">121</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L158">158</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>payload.setParameter(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME, &quot;test.filter&quot;);
        kff.hash(payload);
        assertEquals(&quot;test.filter&quot;, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertTrue(KffDataObjectHandler.hashPresent(payload));
        assertEquals(DATA_MD5, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_CRC32, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_CRC32, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(KffDataObjectHandler.KFF_DUPE_CURRENT_FORM, payload.getFileType());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L158">158</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L196">196</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>&quot;MD5_ORIGINAL should only be populated if hashing more than once&quot;);

        // hash again, to see the effect on the hash-related params.
        // none of the parameters should have a duplicated value

        kff.hash(payload);
        assertEquals(&quot;test.filter&quot;, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertEquals(&quot;test.filter&quot;, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_KNOWN_FILTER_NAME));
        assertTrue(KffDataObjectHandler.hashPresent(payload));
        assertEquals(DATA_MD5, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_MD5, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertEquals(DATA_CRC32, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_CRC32, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/util/magic/MagicMath.java</td>
<td><a href="./xref/emissary/util/magic/MagicMath.html#L31">31</a></td></tr>
<tr class="a">
<td align="left">emissary/util/magic/MagicMath.java</td>
<td><a href="./xref/emissary/util/magic/MagicMath.html#L38">38</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>, 10, -1, -1, -1, 13, -1, 116, -1, 118, -1 // 110
            , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 // 120
            , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 // 130
            , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 // 140
            , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 // 150
            , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 // 160
            , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 // 170
            , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 // 180</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/place/FTestCoordinatePlace.java</td>
<td><a href="./xref-test/emissary/place/FTestCoordinatePlace.html#L37">37</a></td></tr>
<tr class="a">
<td align="left">emissary/place/FTestSkippingCoordinationPlace.java</td>
<td><a href="./xref-test/emissary/place/FTestSkippingCoordinationPlace.html#L38">38</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>place = new CoordinationPlace(configStream);
        config = ConfigUtil.getConfigInfo(new ResourceReader().getConfigDataAsStream(this));
    }

    @Override
    @AfterEach
    public void tearDown() throws Exception {
        demolishServer();
    }

    @Test
    void testRequiredPlaceCreation() throws Exception {
        for (String key : config.findEntries(&quot;SERVICE_COORDINATION&quot;)) {
            assertNotNull(Namespace.lookup(key)); // will throw exception if not present
        }

    }

    @Test
    void testProcessing() throws Exception {
        IBaseDataObject payload = DataObjectFactory.getInstance(&quot;test data&quot;.getBytes(), &quot;test.dat&quot;, place.getPrimaryProxy());
        place.processHeavyDuty(payload);
        assertEquals(config.findStringEntry(OUTPUT_FORM), payload.currentForm(), &quot;Current form must be set by coordinate place&quot;);
    }

    @Test
    void testProcessingWithResourceTracking() throws Exception {
        IBaseDataObject payload = DataObjectFactory.getInstance(&quot;test data&quot;.getBytes(), &quot;test.dat&quot;, place.getPrimaryProxy());
        ResourceWatcher rw = new ResourceWatcher();
        place.processHeavyDuty(payload);
        assertEquals(config.findStringEntry(OUTPUT_FORM), payload.currentForm(), &quot;Current form must be set by coordinate place&quot;);
        Map&lt;String, Timer&gt; resourcesUsed = rw.getStats();
        rw.quit();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/util/CharsetUtil.java</td>
<td><a href="./xref/emissary/util/CharsetUtil.html#L46">46</a></td></tr>
<tr class="a">
<td align="left">emissary/util/CharsetUtil.java</td>
<td><a href="./xref/emissary/util/CharsetUtil.html#L48">48</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>private static final int[] trailingBytesForUtF8 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L344">344</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L394">394</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>assertEquals(&quot;test.filter&quot;, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_BASE + &quot;FILTERED_BY&quot;));
        assertFalse(KffDataObjectHandler.hashPresent(payload));
        assertNull(payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_MD5));
        assertNull(payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertNull(payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_MD5));
        assertNull(payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_BASE + &quot;CRC32&quot;));
        assertNull(payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_BASE + &quot;CRC32&quot;));
        assertNull(payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_BASE + &quot;CRC32&quot;));
        assertNull(payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertNull(payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertNull(payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertNull(payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertNull(payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertNull(payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertNull(payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertNull(payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertNull(payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/filter/JsonOutputFilterTest.java</td>
<td><a href="./xref-test/emissary/output/filter/JsonOutputFilterTest.html#L168">168</a></td></tr>
<tr class="a">
<td align="left">emissary/output/filter/JsonOutputFilterTest.java</td>
<td><a href="./xref-test/emissary/output/filter/JsonOutputFilterTest.html#L201">201</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>config.addEntry(&quot;EXTRA_PARAM&quot;, &quot;*&quot;);
        f.initialize(config, &quot;FOO&quot;, config);

        IBaseDataObject payload = DataObjectFactory.getInstance();
        payload.setData(&quot;This is the data&quot;.getBytes());
        payload.setFileType(&quot;FTYPE&quot;);
        payload.setFilename(&quot;/this/is/a/testfile&quot;);
        payload.putParameter(&quot;FOO&quot;, &quot;myFoo&quot;);
        payload.putParameter(&quot;BAR&quot;, &quot;myBar&quot;);
        payload.putParameter(&quot;BAR_AS_PREFIX&quot;, &quot;myBarPrefix&quot;);
        payload.putParameter(&quot;QUUX&quot;, &quot;myQuux&quot;);
        List&lt;IBaseDataObject&gt; payloadList = new ArrayList&lt;&gt;();
        payloadList.add(payload);

        Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();

        assertTrue(f.isOutputtable(payload, params), &quot;Payload should be outputtable&quot;);
        assertTrue(f.isOutputtable(payloadList, params), &quot;Payload list should be outputtable&quot;);

        ByteArrayOutputStream output = new ByteArrayOutputStream();
        int status = f.filter(payloadList, params, output);
        String s = output.toString();

        assertEquals(IDropOffFilter.STATUS_SUCCESS, status, &quot;Filter should return success&quot;);
        assertTrue(s.contains(&quot;\&quot;QUUX\&quot;:[\&quot;myQuux\&quot;]&quot;), &quot;Filter output should have allowlist field&quot;);
        assertTrue(s.contains(&quot;\&quot;BAR\&quot;:[\&quot;myBar\&quot;]&quot;), &quot;Filter output should have prefix no-match field BAR&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L251">251</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L322">322</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>String[] args = {&quot;--sort&quot;, &quot;sf&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] sizes = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; sizes.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, 2L, sizes[i]);
            wb.setPriority(i);
            mws.addOutboundBundle(wb);

        }

        WorkBundle taken;
        int pri = 0;
        assertEquals(11, mws.getOutboundQueueSize(), &quot;Outbound Queue Size&quot;);
        while ((taken = mws.take(C1)) != null) {
            if (taken.size() != 0) {
                assertEquals(pri, taken.getPriority(), &quot;Ignoring size, priority work must be taken first&quot;);
            } else {
                break; // size = 0 means its the last
            }
            pri++;
        }
    }

    /**
     * Test the WorkBundle sorting of the &quot;largest first&quot; sorting when the priorities are even (and hence, don't override
     * the time based ordering)
     */
    @Test
    void testLargestFirstQueueing() throws Exception {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L132">132</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L322">322</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(KffDataObjectHandler.KFF_DUPE_CURRENT_FORM, payload.getFileType());
        assertArrayEquals(new byte[0], payload.data());
    }

    @Test
    void testHashMethodCalledTwice() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/core/sentinel/protocols/rules/AllMaxTimeTest.java</td>
<td><a href="./xref-test/emissary/core/sentinel/protocols/rules/AllMaxTimeTest.html#L62">62</a></td></tr>
<tr class="a">
<td align="left">emissary/core/sentinel/protocols/rules/AnyMaxTimeTest.java</td>
<td><a href="./xref-test/emissary/core/sentinel/protocols/rules/AnyMaxTimeTest.html#L62">62</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>AgentRule rule = new AllMaxTime(&quot;rule1&quot;, &quot;TestPlace&quot;, 2, 0.75);
        assertFalse(rule.overTimeLimit(placeAgentStats));
    }

    @Nested
    class ConditionTest extends UnitTest {

        final String toUpperLowerPattern = &quot;To(?:Lower|Upper)Place&quot;;
        final String toLowerPlace = &quot;ToLowerPlace&quot;;
        final String toUpperPlace = &quot;ToUpperPlace&quot;;
        final int defaultPoolSize = 5;
        final int defaultTimeLimit = 5;

        AgentPool pool;
        List&lt;AgentProtocol.PlaceAgentStats&gt; stats;

        @Override
        @BeforeEach
        public void setUp() throws Exception {
            super.setUp();
            pool = mock(AgentPool.class);
            stats = stats();
        }

        @Test
        void condition1() {
            assertTrue(testRule(toUpperLowerPattern, defaultTimeLimit, 1.0, defaultPoolSize));
        }

        @Test
        void condition2() {
            assertFalse(testRule(toUpperLowerPattern, defaultTimeLimit, 1.0, defaultPoolSize + 1));
        }

        @Test
        void condition3() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/place/MultiFileUnixCommandPlaceTest.java</td>
<td><a href="./xref-test/emissary/place/MultiFileUnixCommandPlaceTest.html#L95">95</a></td></tr>
<tr class="a">
<td align="left">emissary/place/MultiFileUnixCommandPlaceTest.java</td>
<td><a href="./xref-test/emissary/place/MultiFileUnixCommandPlaceTest.html#L117">117</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>assertEquals(W, new String(payload.data()).trim(), &quot;Clean UTF-8 coming from script must be in parent&quot;);
        assertEquals(1, payload.currentFormSize(), &quot;Single form remaining for parent&quot;);
        assertEquals(1, att.get(0).currentFormSize(), &quot;Single form for child&quot;);

        assertEquals(&quot;copy value&quot;, att.get(0).getStringParameter(&quot;COPY_THIS&quot;), &quot;Child should have propagating metadata value&quot;);
        assertEquals(&quot;copy value&quot;, att.get(0).getParameterAsConcatString(&quot;COPY_THIS&quot;), &quot;Child should have propagating metadata value&quot;);
        assertEquals(&quot;copy value&quot;, att.get(0).getParameterAsString(&quot;COPY_THIS&quot;), &quot;Child should have propagating metadata value&quot;);
        assertNull(att.get(0).getStringParameter(&quot;IGNORE_THIS&quot;), &quot;Child should not have non-propagating metadata value&quot;);
        assertNull(att.get(0).getParameterAsConcatString(&quot;IGNORE_THIS&quot;), &quot;Child should not have non-propagating metadata value&quot;);
        assertNull(att.get(0).getParameterAsString(&quot;IGNORE_THIS&quot;), &quot;Child should not have non-propagating metadata value&quot;);
    }

    @Test
    void testMultiFileUnixCommandPlaceFile() throws Exception {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L132">132</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L425">425</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(KffDataObjectHandler.KFF_DUPE_CURRENT_FORM, payload.getFileType());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L173">173</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L322">322</a></td></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L425">425</a></td></tr>
<tr class="a">
<td colspan="2" align="left">
<div class="source">
<pre>assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(KffDataObjectHandler.KFF_DUPE_CURRENT_FORM, payload.getFileType());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L119">119</a></td></tr>
<tr class="a">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L237">237</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>assertNotNull(this.util.getBestId(this.payload, tld));
        assertEquals(&quot;yes&quot;, this.payload.getStringParameter(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsConcatString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);

        // Test get ID from parameter //////////////////////////////
        cfg = new ServiceConfigGuide();

        ids = new ArrayList&lt;&gt;();
        ids.add(&quot;MY_ID&quot;);
        ids.add(&quot;SHORTNAME&quot;);
        ids.add(&quot;AUTO_GENERATED_ID&quot;);
        cfg.addEntries(&quot;ID&quot;, ids);

        this.payload = DataObjectFactory.getInstance(&quot;This is a test&quot;.getBytes(), &quot;/eat/prefix/testPath&quot;, &quot;UNKNOWN&quot;);
        this.payload.setParameter(&quot;MY_ID&quot;, &quot;672317892139&quot;);
        this.util = new DropOffUtil(cfg);
        id = this.util.getBestId(this.payload, tld);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L175">175</a></td></tr>
<tr class="a">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L293">293</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>id = this.util.getBestId(this.payload, tld);

        assertEquals(&quot;yes&quot;, this.payload.getStringParameter(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsConcatString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertNotEquals(&quot;testPath&quot;, id, &quot;the SHORTNAME parameter should NOT have been used&quot;);
        assertTrue(id.startsWith(&quot;ABCD&quot;), &quot;auto gen id should start with a (truncated to 4 char) prefix&quot;);

        // Test force auto gen by specifying nothing
        // //////////////////////////////

        cfg = new ServiceConfigGuide();

        ids = new ArrayList&lt;&gt;();
        cfg.addEntries(&quot;ID&quot;, ids);

        cfg.addEntry(&quot;AUTO_GENERATED_ID_PREFIX&quot;, &quot;ABCDEFGH&quot;);

        this.payload = DataObjectFactory.getInstance(&quot;This is a test&quot;.getBytes(), &quot;&quot;, &quot;UNKNOWN&quot;);// shortname is blank

        this.util = new DropOffUtil(cfg);
        id = this.util.getBestId(this.payload, tld);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/util/search/FastBoyerMoore.java</td>
<td><a href="./xref/emissary/util/search/FastBoyerMoore.html#L99">99</a></td></tr>
<tr class="a">
<td align="left">emissary/util/search/FastBoyerMoore.java</td>
<td><a href="./xref/emissary/util/search/FastBoyerMoore.html#L137">137</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>final int ch = this.data[pos] &amp; 0x7f;
            final int jump = this.lookup[ch];
            BackwardsTreeScanner.State state = this.root.nextStates[ch];
            int curPos = pos - 1;
            while ((state != null) &amp;&amp; (curPos &gt;= 0)) {
                if (state.matches != null) {
                    for (int i = 0; i &lt; state.matches.length; i++) {
                        final int id = state.matches[i];
                        final int[] tmp = new int[3];
                        tmp[0] = curPos + 1;
                        tmp[1] = id;
                        tmp[2] = pos - curPos;
                        result.add(tmp);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/core/IBaseDataObjectXmlHelperTest.java</td>
<td><a href="./xref-test/emissary/core/IBaseDataObjectXmlHelperTest.html#L232">232</a></td></tr>
<tr class="a">
<td align="left">emissary/core/IBaseDataObjectXmlHelperTest.java</td>
<td><a href="./xref-test/emissary/core/IBaseDataObjectXmlHelperTest.html#L253">253</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>setAllFieldsPrintable(ibdo, bytes);

        final String xmlString = IBaseDataObjectXmlHelper.xmlFromIbdo(ibdo, children, ibdo, DEFAULT_ELEMENT_ENCODERS);

        final SAXBuilder builder = new SAXBuilder(XMLReaders.NONVALIDATING);
        final Document document = builder.build(new StringReader(xmlString));
        final Element root = document.getRootElement();

        assertNull(checkLengthElement(root, (int) ibdo.getChannelSize(), &quot;answers&quot;, &quot;data&quot;));
        assertNull(checkLengthElement(root, ibdo.footer().length, &quot;answers&quot;, &quot;footer&quot;));
        assertNull(checkLengthElement(root, ibdo.header().length, &quot;answers&quot;, &quot;header&quot;));
        assertNull(checkLengthKeyValue(root, ibdo.getAlternateView(&quot;AlternateView1Key&quot;).length, &quot;AlternateView1Key&quot;, &quot;answers&quot;, &quot;view&quot;));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffChainTest.java</td>
<td><a href="./xref-test/emissary/kff/KffChainTest.html#L26">26</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffChainTest.java</td>
<td><a href="./xref-test/emissary/kff/KffChainTest.html#L51">51</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>chain.addAlgorithm(&quot;SHA-256&quot;);

        assertEquals(3, chain.getAlgorithms().size(), &quot;Algorithms stored in chain&quot;);

        try {
            ChecksumResults cr = chain.computeSums(DATA);
            Set&lt;String&gt; algs = cr.getResultsPresent();
            assertNotNull(algs, &quot;Algorithm set returned&quot;);
            assertEquals(3, algs.size(), &quot;All results present&quot;);
            Iterator&lt;String&gt; i = algs.iterator();
            assertEquals(&quot;MD5&quot;, i.next(), &quot;MD5 alg present&quot;);
            assertEquals(&quot;SHA-1&quot;, i.next(), &quot;SHA-1 alg present&quot;);
            assertEquals(&quot;SHA-256&quot;, i.next(), &quot;SHA-256 alg present&quot;);
        } catch (Exception ex) {
            fail(&quot;Could not compute results&quot;, ex);
        }
    }

    @Test
    void testAlgorithmsUsedWithSetAlgorithm() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L167">167</a></td></tr>
<tr class="a">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L188">188</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>ids.add(&quot;SHORTNAME&quot;);
        cfg.addEntries(&quot;ID&quot;, ids);

        cfg.addEntry(&quot;AUTO_GENERATED_ID_PREFIX&quot;, &quot;ABCDEFGH&quot;);

        this.payload = DataObjectFactory.getInstance(&quot;This is a test&quot;.getBytes(), &quot;&quot;, &quot;UNKNOWN&quot;);// shortname is blank

        this.util = new DropOffUtil(cfg);
        id = this.util.getBestId(this.payload, tld);

        assertEquals(&quot;yes&quot;, this.payload.getStringParameter(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsConcatString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertNotEquals(&quot;testPath&quot;, id, &quot;the SHORTNAME parameter should NOT have been used&quot;);
        assertTrue(id.startsWith(&quot;ABCD&quot;), &quot;auto gen id should start with a (truncated to 4 char) prefix&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L285">285</a></td></tr>
<tr class="a">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L306">306</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>ids.add(&quot;SHORTNAME&quot;);
        cfg.addEntries(&quot;ID&quot;, ids);

        cfg.addEntry(&quot;AUTO_GENERATED_ID_PREFIX&quot;, &quot;ABCDEFGH&quot;);

        this.payload = DataObjectFactory.getInstance(&quot;This is a test&quot;.getBytes(), &quot;&quot;, &quot;UNKNOWN&quot;);// shortname is blank

        this.util = new DropOffUtil(cfg);
        id = this.util.getBestIdFrom(this.payload);

        assertEquals(&quot;yes&quot;, this.payload.getStringParameter(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsConcatString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertEquals(&quot;yes&quot;, this.payload.getParameterAsString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should have been set&quot;);
        assertNotEquals(&quot;testPath&quot;, id, &quot;the SHORTNAME parameter should NOT have been used&quot;);
        assertTrue(id.startsWith(&quot;ABCD&quot;), &quot;auto gen id should start with a (truncated to 4 char) prefix&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/directory/DirectoryEntryTest.java</td>
<td><a href="./xref-test/emissary/directory/DirectoryEntryTest.html#L123">123</a></td></tr>
<tr class="a">
<td align="left">emissary/directory/DirectoryEntryTest.java</td>
<td><a href="./xref-test/emissary/directory/DirectoryEntryTest.html#L133">133</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>this.d.proxyFor(proxyKey);
        assertEquals(cost, this.d.getCost(), &quot;Proxy cost&quot;);
        assertEquals(quality, this.d.getQuality(), &quot;Proxy qual&quot;);
        assertEquals(KeyManipulator.getServiceType(key), this.d.getServiceType(), &quot;Proxy service type&quot;);
        assertEquals(KeyManipulator.getServiceName(key), this.d.getServiceName(), &quot;Proxy service name&quot;);
        assertEquals(KeyManipulator.getDataType(key), KeyManipulator.getDataType(this.d.getKey()), &quot;Proxy data type&quot;);
        assertEquals(DirectoryEntry.calculateExpense(cost, quality), this.d.getExpense(), &quot;Proxy expense&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L208">208</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L322">322</a></td></tr>
<tr class="b">
<td align="left">emissary/kff/KffDataObjectHandlerTest.java</td>
<td><a href="./xref-test/emissary/kff/KffDataObjectHandlerTest.html#L425">425</a></td></tr>
<tr class="a">
<td colspan="2" align="left">
<div class="source">
<pre>assertEquals(DATA_CRC32, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_CRC32));
        assertEquals(DATA_SSDEEP, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SSDEEP, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SSDEEP));
        assertEquals(DATA_SHA1, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA1, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA1));
        assertEquals(DATA_SHA256, payload.getStringParameter(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsConcatString(KffDataObjectHandler.KFF_PARAM_SHA256));
        assertEquals(DATA_SHA256, payload.getParameterAsString(KffDataObjectHandler.KFF_PARAM_SHA256));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L71">71</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L107">107</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>void testOldestFirstQueueing() throws Exception {
        String[] args = {&quot;--sort&quot;, &quot;of&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] times = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; times.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, times[i], 5L);
            wb.setPriority(1); // uniform priority to ensure times are used, not priority</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L143">143</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L179">179</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>void testYoungestFirstQueueing() throws Exception {
        String[] args = {&quot;--sort&quot;, &quot;yf&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] times = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; times.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, times[i], 2L);
            wb.setPriority(1); // uniform priority to make sure time sorting works</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L214">214</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L250">250</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>void testSmallestFirstQueueing() throws Exception {
        String[] args = {&quot;--sort&quot;, &quot;sf&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] sizes = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; sizes.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, 2L, sizes[i]);
            wb.setPriority(1); // uniform priority, so the time ordering is used</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L215">215</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L286">286</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>String[] args = {&quot;--sort&quot;, &quot;sf&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] sizes = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; sizes.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, 2L, sizes[i]);
            wb.setPriority(1); // uniform priority, so the time ordering is used
            mws.addOutboundBundle(wb);

        }

        // This should be in order of 0,1,2,3.....10
        WorkBundle taken;
        long sz = 0L;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L285">285</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L321">321</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>void testLargestFirstQueueing() throws Exception {
        String[] args = {&quot;--sort&quot;, &quot;lf&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] sizes = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; sizes.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, 2L, sizes[i]);
            wb.setPriority(1); // uniform priority to sort by size</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L154">154</a></td></tr>
<tr class="a">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L272">272</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>id = this.util.getBestId(this.payload, tld);

        assertNull(this.payload.getStringParameter(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should NOT have been set&quot;);
        assertNull(this.payload.getParameterAsConcatString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should NOT have been set&quot;);
        assertNull(this.payload.getParameterAsString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should NOT have been set&quot;);
        assertEquals(&quot;testPath&quot;, id, &quot;the SHORTNAME parameter should have been used&quot;);

        // Test force auto gen by specifying a blank shortname
        // //////////////////////////////

        cfg = new ServiceConfigGuide();

        ids = new ArrayList&lt;&gt;();
        ids.add(&quot;SHORTNAME&quot;);
        cfg.addEntries(&quot;ID&quot;, ids);

        cfg.addEntry(&quot;AUTO_GENERATED_ID_PREFIX&quot;, &quot;ABCDEFGH&quot;);

        this.payload = DataObjectFactory.getInstance(&quot;This is a test&quot;.getBytes(), &quot;&quot;, &quot;UNKNOWN&quot;);// shortname is blank

        this.util = new DropOffUtil(cfg);
        id = this.util.getBestId(this.payload, tld);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L91">91</a></td></tr>
<tr class="a">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L208">208</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>Configurator cfg = new ServiceConfigGuide();
        final List&lt;String&gt; dates = new ArrayList&lt;&gt;();
        dates.add(EVENT_DATE);
        dates.add(FILE_DATE);
        cfg.addEntries(&quot;DATE_FORMAT&quot;, dates);

        List&lt;String&gt; ids = new ArrayList&lt;&gt;();
        ids.add(&quot;AUTO_GENERATED_ID&quot;);
        cfg.addEntries(&quot;ID&quot;, ids);

        cfg.addEntry(&quot;DATE_FORMAT&quot;, &quot;E, d MMM yyyy HH:mm:ss Z&quot;);

        cfg.addEntry(&quot;AUTO_GENERATED_ID_PREFIX&quot;, &quot;ABCDEFGH&quot;);

        this.util = new DropOffUtil(cfg);
        this.payload = DataObjectFactory.getInstance(&quot;This is a test&quot;.getBytes(), &quot;/eat/prefix/testPath&quot;, &quot;UNKNOWN&quot;);
        String id = this.util.getBestId(this.payload, tld);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L136">136</a></td></tr>
<tr class="a">
<td align="left">emissary/output/DropOffUtilTest.java</td>
<td><a href="./xref-test/emissary/output/DropOffUtilTest.html#L254">254</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>id = this.util.getBestId(this.payload, tld);

        assertNull(this.payload.getStringParameter(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should NOT have been set&quot;);
        assertNull(this.payload.getParameterAsConcatString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should NOT have been set&quot;);
        assertNull(this.payload.getParameterAsString(&quot;AUTO_GENERATED_ID&quot;), &quot;an auto gen id parameter should NOT have been set&quot;);
        assertEquals(&quot;672317892139&quot;, id, &quot;the MY_ID parameter should have been used&quot;);

        // Test shortname //////////////////////////////
        cfg = new ServiceConfigGuide();

        ids = new ArrayList&lt;&gt;();
        ids.add(&quot;SHORTNAME&quot;);
        ids.add(&quot;AUTO_GENERATED_ID&quot;);
        cfg.addEntries(&quot;ID&quot;, ids);

        this.payload = DataObjectFactory.getInstance(&quot;This is a test&quot;.getBytes(), &quot;/eat/prefix/testPath&quot;, &quot;UNKNOWN&quot;);

        this.util = new DropOffUtil(cfg);
        id = this.util.getBestId(this.payload, tld);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/transform/decode/JavascriptEscape.java</td>
<td><a href="./xref/emissary/transform/decode/JavascriptEscape.html#L18">18</a></td></tr>
<tr class="a">
<td align="left">emissary/transform/decode/JsonEscape.java</td>
<td><a href="./xref/emissary/transform/decode/JsonEscape.html#L20">20</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>if (data[i] == '\\' &amp;&amp; (i + 5) &lt; data.length &amp;&amp; data[i + 1] == 'u') {
                // process unicode escape
                try {
                    String s = new String(data, i + 2, 4);
                    char[] c = HtmlEscape.unescapeHtmlChar(s, true);
                    if (c != null &amp;&amp; c.length &gt; 0) {
                        out.write(new String(c).getBytes());
                        // logger.debug(&quot;Unicode '{}' ==&gt; '{}'&quot;, s, new String(c));
                        i += 5;
                    } else {
                        out.write(data[i]);
                    }
                } catch (IOException iox) {
                    out.write(data[i]);
                }
            } else if (data[i] == '\\' &amp;&amp; (i + 1) &lt; data.length &amp;&amp; (data[i + 1] == 'n' || data[i + 1] == 'r')) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkBundleTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkBundleTest.html#L141">141</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkBundleTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkBundleTest.html#L176">176</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>w.addFileName(&quot;&lt;file2.txt&amp;foo=bar&gt;&quot;, 7L, 10L);
        w.setPriority(1);
        w.setSimpleMode(false);

        String xml = null;
        try {
            xml = w.toXml();
        } catch (RuntimeException ex) {
            fail(&quot;Cannot generate xml&quot;, ex);
        }
        assertNotNull(xml, &quot;Generated xml&quot;);
        WorkBundle w2 = WorkBundle.buildWorkBundle(xml);
        assertNotNull(w2, &quot;Generated from xml&quot;);
        assertEquals(w.getOutputRoot(), w2.getOutputRoot(), &quot;Value across xml&quot;);
        assertEquals(w.getEatPrefix(), w2.getEatPrefix(), &quot;Value across xml&quot;);
        assertEquals(w.getCaseId(), w2.getCaseId(), &quot;Value across xml&quot;);
        assertEquals(w.getYoungestFileModificationTime(), w2.getYoungestFileModificationTime(), &quot;Youngest time across xml&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/server/mvc/internal/DeregisterPlaceActionTest.java</td>
<td><a href="./xref-test/emissary/server/mvc/internal/DeregisterPlaceActionTest.html#L66">66</a></td></tr>
<tr class="a">
<td align="left">emissary/server/mvc/internal/FailDirectoryActionTest.java</td>
<td><a href="./xref-test/emissary/server/mvc/internal/FailDirectoryActionTest.html#L72">72</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>try (Response response = target(DEREGISTER_PLACE_ACTION).request().post(Entity.form(formParams))) {
            // verify
            final int status = response.getStatus();
            assertEquals(500, status);
            final String result = response.readEntity(String.class);
            assertTrue(result.startsWith(&quot;Bad params:&quot;));
        }
    }

    @ParameterizedTest
    @ValueSource(strings = {&quot;test\n\r&quot;, &quot;\n&quot;, &quot;\r&quot;})
    void cleanParams(String paramsToSanitize) {
        // setup
        formParams.replace(TARGET_DIRECTORY, Collections.singletonList(paramsToSanitize));
        formParams.replace(ADD_KEY, Collections.singletonList(paramsToSanitize));

        // test
        try (Response response = target(DEREGISTER_PLACE_ACTION).request().post(Entity.form(formParams))) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/kff/KffFileTest.java</td>
<td><a href="./xref-test/emissary/kff/KffFileTest.html#L43">43</a></td></tr>
<tr class="a">
<td align="left">emissary/kff/KffFileTest.java</td>
<td><a href="./xref-test/emissary/kff/KffFileTest.html#L79">79</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>private static final byte[] expectedSha1Bytes = {(byte) 0, (byte) 0, (byte) 0, (byte) 32, (byte) 103, (byte) 56, (byte) 116,
            (byte) -114, (byte) -35, (byte) -110, (byte) -60, (byte) -29, (byte) -46, (byte) -24, (byte) 35, (byte) -119,
            (byte) 103, (byte) 0, (byte) -8, (byte) 73};</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/FTestMultipleWorkSpaces.java</td>
<td><a href="./xref-test/emissary/pickup/FTestMultipleWorkSpaces.html#L59">59</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/FTestWorkSpaceMaxBundleSize.java</td>
<td><a href="./xref-test/emissary/pickup/FTestWorkSpaceMaxBundleSize.html#L48">48</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>outarea1 = new File(TMPDIR + &quot;/multipicktest/space1/out&quot;);
        outarea1.mkdirs();

        holdarea = new File(TMPDIR, &quot;/data/HoldData&quot;);
        holdarea.mkdirs();

        File testfile = File.createTempFile(&quot;temp1&quot;, &quot;.dat&quot;, inarea1);
        workingFiles.add(testfile);
        workingFilePaths.add(testfile.getName());
        testfile.deleteOnExit();

        inareadir1 = new File(inarea1, &quot;subdir1&quot;);
        inareadir1.mkdirs();
        inareadir1.deleteOnExit();
        File testfile2 = File.createTempFile(&quot;temp2&quot;, &quot;.dat&quot;, inareadir1);
        workingFiles.add(testfile2);
        workingFilePaths.add(&quot;subdir1/&quot; + testfile2.getName());
        testfile2.deleteOnExit();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkBundleTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkBundleTest.html#L141">141</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkBundleTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkBundleTest.html#L208">208</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>w.addFileName(&quot;&lt;file2.txt&amp;foo=bar&gt;&quot;, 7L, 10L);
        w.setPriority(1);
        w.setSimpleMode(false);

        String xml = null;
        try {
            xml = w.toXml();
        } catch (RuntimeException ex) {
            fail(&quot;Cannot generate xml&quot;, ex);
        }
        assertNotNull(xml, &quot;Generated xml&quot;);
        WorkBundle w2 = WorkBundle.buildWorkBundle(xml);
        assertNotNull(w2, &quot;Generated from xml&quot;);
        assertEquals(w.getOutputRoot(), w2.getOutputRoot(), &quot;Value across xml&quot;);
        assertEquals(w.getEatPrefix(), w2.getEatPrefix(), &quot;Value across xml&quot;);
        assertEquals(w.getCaseId(), w2.getCaseId(), &quot;Value across xml&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkBundleTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkBundleTest.html#L159">159</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkBundleTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkBundleTest.html#L193">193</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>assertEquals(w.getTotalFileSize(), w2.getTotalFileSize(), &quot;Total filesize across xml&quot;);
        assertEquals(w.size(), w2.size(), &quot;Files across xml&quot;);
        assertEquals(w.getPriority(), w2.getPriority(), &quot;Priority across xml&quot;);
        assertEquals(w.getSimpleMode(), w2.getSimpleMode(), &quot;Simple mode across xml&quot;);
        List&lt;String&gt; w2l = w2.getFileNameList();
        assertNotNull(w2l, &quot;File list from xml&quot;);
        assertEquals(2, w2l.size(), &quot;Size of file list from xml&quot;);
        assertEquals(&quot;file1.txt&quot;, w2l.get(0), &quot;File values from xml&quot;);
        assertEquals(&quot;&lt;file2.txt&amp;foo=bar&gt;&quot;, w2l.get(1), &quot;File values from xml&quot;);
    }

    @Test
    void testBundleXmlWithDefaultTimes() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L215">215</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L322">322</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>String[] args = {&quot;--sort&quot;, &quot;sf&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] sizes = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; sizes.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, 2L, sizes[i]);
            wb.setPriority(1); // uniform priority, so the time ordering is used</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L251">251</a></td></tr>
<tr class="a">
<td align="left">emissary/pickup/WorkSpaceTest.java</td>
<td><a href="./xref-test/emissary/pickup/WorkSpaceTest.html#L286">286</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>String[] args = {&quot;--sort&quot;, &quot;sf&quot;, &quot;-i&quot;, &quot;blah&quot;};
        mws = new MyWorkSpace(FeedCommand.parse(FeedCommand.class, args));

        String C1 = &quot;INITIAL.INPUT.A.http://otherhost:7001/FilePickUpClient&quot;;
        mws.addPickUp(C1);

        long[] sizes = {4, 5, 3, 1, 2, 7, 0, 8, 9, 10, 6};
        for (int i = 0; i &lt; sizes.length; i++) {
            // Set up some fake work
            WorkBundle wb = new WorkBundle(&quot;/fake/root&quot;, &quot;/fake/eat&quot;);
            wb.addFileName(&quot;faker-&quot; + i + &quot;.txt&quot;, 2L, sizes[i]);
            wb.setPriority(i);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/output/filter/JsonOutputFilterTest.java</td>
<td><a href="./xref-test/emissary/output/filter/JsonOutputFilterTest.html#L145">145</a></td></tr>
<tr class="a">
<td align="left">emissary/output/filter/JsonOutputFilterTest.java</td>
<td><a href="./xref-test/emissary/output/filter/JsonOutputFilterTest.html#L178">178</a></td></tr>
<tr class="b">
<td align="left">emissary/output/filter/JsonOutputFilterTest.java</td>
<td><a href="./xref-test/emissary/output/filter/JsonOutputFilterTest.html#L211">211</a></td></tr>
<tr class="a">
<td align="left">emissary/output/filter/JsonOutputFilterTest.java</td>
<td><a href="./xref-test/emissary/output/filter/JsonOutputFilterTest.html#L234">234</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>payload.appendParameter(&quot;BAR&quot;, &quot;foo&quot;);

        List&lt;IBaseDataObject&gt; payloadList = new ArrayList&lt;&gt;();
        payloadList.add(payload);

        Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();

        assertTrue(f.isOutputtable(payload, params), &quot;Payload should be outputtable&quot;);
        assertTrue(f.isOutputtable(payloadList, params), &quot;Payload list should be outputtable&quot;);

        ByteArrayOutputStream output = new ByteArrayOutputStream();
        int status = f.filter(payloadList, params, output);
        String s = output.toString();

        assertEquals(IDropOffFilter.STATUS_SUCCESS, status, &quot;Filter should return success&quot;);
        assertTrue(s.contains(&quot;\&quot;BAR\&quot;:[\&quot;foo\&quot;]&quot;), &quot;Filter output should contain field BAR&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td align="left">emissary/core/channels/LoggingChannelFactoryTest.java</td>
<td><a href="./xref-test/emissary/core/channels/LoggingChannelFactoryTest.html#L101">101</a></td></tr>
<tr class="a">
<td align="left">emissary/core/channels/LoggingInputStreamFactoryTest.java</td>
<td><a href="./xref-test/emissary/core/channels/LoggingInputStreamFactoryTest.html#L106">106</a></td></tr>
<tr class="b">
<td colspan="2" align="left">
<div class="source">
<pre>private static void check(final ListAppender&lt;ILoggingEvent&gt; appender, final String message,
            final boolean testStackTrace) {
        assertEquals(1, appender.list.size());

        final ILoggingEvent loggingEvent = appender.list.get(0);

        assertEquals(message, loggingEvent.getFormattedMessage());

        final IThrowableProxy throwableProxy = loggingEvent.getThrowableProxy();

        if (testStackTrace) {
            assertNotNull(throwableProxy);
            assertEquals(&quot;java.lang.Throwable&quot;, throwableProxy.getClassName());
            assertEquals(&quot;DEBUG&quot;, throwableProxy.getMessage());
        } else {
            assertNull(throwableProxy);
        }

        appender.list.clear();
    }

    private static class TestFileChannelFactory implements SeekableByteChannelFactory {</pre></div></td></tr></table></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2025<a href="https://code.nsa.gov">National Security Agency</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
